var le=Object.defineProperty;var ce=(a,i,t)=>i in a?le(a,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[i]=t;var u=(a,i,t)=>(ce(a,typeof i!="symbol"?i+"":i,t),t),kt=(a,i,t)=>{if(!i.has(a))throw TypeError("Cannot "+t)};var e=(a,i,t)=>(kt(a,i,"read from private field"),t?t.call(a):i.get(a)),r=(a,i,t)=>{if(i.has(a))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(a):i.set(a,t)},n=(a,i,t,s)=>(kt(a,i,"write to private field"),s?s.call(a,t):i.set(a,t),t);var f=(a,i,t)=>(kt(a,i,"access private method"),t);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))s(h);new MutationObserver(h=>{for(const l of h)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(h){const l={};return h.integrity&&(l.integrity=h.integrity),h.referrerPolicy&&(l.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?l.credentials="include":h.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(h){if(h.ep)return;h.ep=!0;const l=t(h);fetch(h.href,l)}})();const Tt={pixelSize:3,scorePerType:{1:10,2:20,3:40},defaults:{type:2}},St={defaults:{rows:5,sideStep:3,downStep:5}},ht={pixelSize:3,updateStep:15,reload:200,marginBottom:40,defaults:{direction:-1}},Mt={pixelSize:7,marginBottom:20},mt=60,o={Enter:"Enter",Escape:"Escape",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",Pause:"Pause",ArrowRight:"ArrowRight",Space:"Space",ArrowUp:"ArrowUp"},A={Hit:"Hit",Overfly:"Overfly",Collision:"Collision"},Ut={font:"48px Helvetica",textBaseline:"middle",textAlign:"center"},fe={isStarted:!1,isOver:!1,isPaused:!1,lives:3,totalScore:0},$t={pixelSize:10,position:{x:0,y:0}};class qt{constructor(){u(this,"events",{})}on(i,t){return this.events[i]||(this.events[i]=[]),this.events[i].push(t),this}off(i,t){return this.removeListener(i,t)}emit(i,...t){const s=this.events[i];return Array.isArray(s)?(s.forEach(h=>{h(...t)}),!0):!1}addListener(i,t){return this.on(i,t)}removeListener(i,t){const s=this.events[i];if(s){const h=s.indexOf(t);h!==-1&&s.splice(h,1)}return this}}var B,N,$,j,G,M,_,R,z;class de extends qt{constructor(){super();r(this,R);r(this,B,new Set);r(this,N,void 0);r(this,$,void 0);r(this,j,void 0);r(this,G,void 0);r(this,M,void 0);r(this,_,void 0);n(this,N,f(this,R,z).call(this,o.ArrowLeft)),n(this,$,f(this,R,z).call(this,o.ArrowRight)),n(this,j,f(this,R,z).call(this,o.Enter)),n(this,G,f(this,R,z).call(this,o.Escape)),n(this,M,f(this,R,z).call(this,o.Pause)),n(this,_,f(this,R,z).call(this,o.Space)),this.subscribeListeners()}subscribeListeners(){this.on(o.ArrowLeft,e(this,N)),this.on(o.ArrowRight,e(this,$)),this.on(o.Enter,e(this,j)),this.on(o.Escape,e(this,G)),this.on(o.Pause,e(this,M)),this.on(o.Space,e(this,_))}unsubscribeListeners(){this.off(o.ArrowLeft,e(this,N)),this.off(o.ArrowRight,e(this,$)),this.off(o.Enter,e(this,j)),this.off(o.Escape,e(this,G)),this.off(o.Pause,e(this,M)),this.off(o.Space,e(this,_))}onKeyDown(t){switch(t.code){case o.ArrowLeft:this.emit(o.ArrowLeft,{keyUp:!1});break;case o.ArrowRight:this.emit(o.ArrowRight,{keyUp:!1});break}}onKeyUp(t){switch(t.code){case o.ArrowLeft:this.emit(o.ArrowLeft,{keyUp:!0});break;case o.ArrowRight:this.emit(o.ArrowRight,{keyUp:!0});break;case o.Enter:this.emit(o.Enter,{keyUp:!0});break;case o.Escape:this.emit(o.Escape,{keyUp:!0});break;case o.Pause:this.emit(o.Pause,{keyUp:!0});break;case o.Space:this.emit(o.Space,{keyUp:!0});break}}isLeftPressed(){return e(this,B).has(o.ArrowLeft)}isRightPressed(){return e(this,B).has(o.ArrowRight)}}B=new WeakMap,N=new WeakMap,$=new WeakMap,j=new WeakMap,G=new WeakMap,M=new WeakMap,_=new WeakMap,R=new WeakSet,z=function(t){return s=>{s.keyUp?e(this,B).delete(t):e(this,B).add(t)}};var P,wt,_t;class ue extends qt{constructor(t={}){super();r(this,wt);r(this,P,void 0);n(this,P,t)}get(t){if(!(t in e(this,P)))throw new Error(`${t}: such state prop doesn't exist`);return e(this,P)[t]}update(t,s){s?n(this,P,t):f(this,wt,_t).call(this,t)}}P=new WeakMap,wt=new WeakSet,_t=function(t){Object.keys(t).forEach(s=>{s in e(this,P)&&e(this,P)[s]!==t[s]&&(e(this,P)[s]=t[s],this.emit(`${s}`,e(this,P)[s]))})};class Wt{constructor(i){u(this,"ctx");u(this,"width");u(this,"height");u(this,"gameState",null);u(this,"gameControls",null);u(this,"gameSounds",null);this.ctx=i,this.width=i.canvas.width,this.height=i.canvas.height}connect(i,t,s){this.gameState=i,this.gameControls=t,this.gameSounds=s}clear(){this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.width,this.height)}render(){this.clear()}}var Y;class pe extends Wt{constructor(t){super(t);r(this,Y,void 0);n(this,Y,()=>{var s;return(s=this.gameState)==null?void 0:s.update({isStarted:!1,isOver:!1,totalScore:0})})}connect(t,s,h){var l;super.connect(t,s,h),(l=this.gameControls)==null||l.on(o.Escape,e(this,Y)),this.render()}leave(){var t;(t=this.gameControls)==null||t.off(o.Escape,e(this,Y))}render(){var h;super.render();const[t,s]=[this.width/2,this.height/2-60];this.ctx.fillStyle="#ffffff",this.ctx.fillText("Game Over",t,s),this.ctx.fillText(`Your score: ${(h=this.gameState)==null?void 0:h.get("totalScore")}`,t,s+60),this.ctx.fillText("Press `Esc` to start",t,s+120),this.ctx.fillText("a new game",t,s+180)}}Y=new WeakMap;var V;class jt extends Wt{constructor(t){super(t);r(this,V,void 0);n(this,V,()=>{var s;return(s=this.gameState)==null?void 0:s.update({isStarted:!0})})}connect(t,s,h){var l;super.connect(t,s,h),(l=this.gameControls)==null||l.on(o.Enter,e(this,V)),this.render()}leave(){var t;(t=this.gameControls)==null||t.off(o.Enter,e(this,V))}render(){super.render();const[t,s]=[this.width/2,this.height/2-60];this.ctx.fillStyle="#ffffff",this.ctx.fillText("Space Invaders",t,s),this.ctx.fillText("Press `Enter` to start",t,s+60)}}V=new WeakMap;var d,vt,Yt,xt,Vt,Pt,Jt;class ge extends qt{constructor(){super();r(this,vt);r(this,xt);r(this,Pt);r(this,d,void 0);n(this,d,{invadersFleet:null,laserRay:null,playerShip:null})}watch(t){Object.keys(t).forEach(s=>{e(this,d)[s]=t[s]})}unwatch(t){Object.keys(t).forEach(s=>{e(this,d)[s]=null})}checkPositions(){e(this,d).laserRay&&f(this,Pt,Jt).call(this),e(this,d).laserRay&&e(this,d).invadersFleet&&f(this,xt,Vt).call(this),e(this,d).playerShip&&e(this,d).invadersFleet&&f(this,vt,Yt).call(this)}}d=new WeakMap,vt=new WeakSet,Yt=function(){var l;if(e(this,d).playerShip===null||e(this,d).invadersFleet===null)return;const t=(l=e(this,d).playerShip)==null?void 0:l.getBorders(),s=e(this,d).invadersFleet.getInvaders();Array.from(s.entries()).forEach(([c,w])=>{if(w){const p=w.getBorders();t&&t.right<p.left||t&&t.left>p.right||t&&t.top>p.bottom||t&&t.bottom<p.top||this.emit(A.Collision)}})},xt=new WeakSet,Vt=function(){var l,c;if(e(this,d).laserRay===null||e(this,d).invadersFleet===null)return;const t=(l=e(this,d).laserRay)==null?void 0:l.position,s=(c=e(this,d).invadersFleet)==null?void 0:c.getInvaders();Array.from(s.entries()).forEach(([w,p])=>{if(p){const v=p.getPosition(),st=p.getOriginalWidth(),Nt=p.getOriginalHeight();t&&t.x>=v.x-st/2&&t.x<=v.x+st/2&&t.y>=v.y-Nt/2&&t.y<=v.y+Nt/2&&this.emit(A.Hit,w)}})},Pt=new WeakSet,Jt=function(){var s,h;if(e(this,d).laserRay===null)return;const t=(h=(s=e(this,d).laserRay)==null?void 0:s.position)==null?void 0:h.y;t&&t<0&&this.emit(A.Overfly)};const Se=[[[0,0,0,0,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,0],[1,1,1,0,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,0,0,0],[0,0,1,1,0,1,0,1,1,0,0],[1,1,0,0,0,0,0,0,0,1,1]],[[0,0,0,0,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,0],[1,1,1,0,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,0,0,0],[0,0,1,0,0,1,0,0,1,0,0],[0,0,0,1,0,0,0,1,0,0,0]]],ye=[[[0,0,1,0,0,0,0,0,1,0,0],[0,0,0,1,0,0,0,1,0,0,0],[0,0,1,1,1,1,1,1,1,0,0],[0,1,1,0,1,1,1,0,1,1,0],[1,1,1,1,1,1,1,1,1,1,1],[1,0,1,1,1,1,1,1,1,0,1],[1,0,1,0,0,0,0,0,1,0,1],[0,0,0,1,1,0,1,1,0,0,0]],[[0,0,1,0,0,0,0,0,1,0,0],[1,0,0,1,0,0,0,1,0,0,1],[1,0,1,1,1,1,1,1,1,0,1],[1,1,1,0,1,1,1,0,1,1,1],[0,1,1,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0,0],[0,0,1,0,0,0,0,0,1,0,0],[0,1,0,0,0,0,0,0,0,1,0]]],me=[[[0,0,0,0,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,0],[1,1,1,0,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,0,0,0,1,0,0,0],[0,0,1,0,1,1,1,0,1,0,0],[0,1,0,1,0,0,0,1,0,1,0]],[[0,0,0,0,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,0],[1,1,1,0,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,0,0,0,1,0,0,0],[0,0,1,0,0,0,0,0,1,0,0],[0,0,0,1,0,0,0,1,0,0,0]]];class Kt{constructor(i){u(this,"frames");u(this,"totalFrames");u(this,"pixelSize");u(this,"position");u(this,"runningFrame");u(this,"width");u(this,"height");this.frames=i,this.totalFrames=i.length,this.pixelSize=$t.pixelSize,this.position=$t.position,this.runningFrame=0,this.width=i[0][0].length*this.pixelSize,this.height=i[0].length*this.pixelSize}getWidth(){return this.width}getHeight(){return this.height}getBorders(){return{top:this.position.y-this.height/2,right:this.position.x+this.width/2,bottom:this.position.y+this.height/2,left:this.position.x-this.width/2}}getPosition(){return this.position}setPosition(i){this.position=i}update(){this.runningFrame+=1,this.runningFrame>=mt&&(this.runningFrame=0)}draw(i){i.fillStyle="#ffffff";const t=Math.floor(this.runningFrame/Math.floor(mt/this.totalFrames)),s=this.frames[t];let h=-1;for(;++h<s.length;){let l=-1;for(;++l<s[h].length;)s[h][l]&&i.fillRect(this.position.x-this.width/2+this.pixelSize*l,this.position.y-this.height/2+this.pixelSize*h,this.pixelSize,this.pixelSize)}}}class yt extends Kt{constructor(t=Tt.defaults.type){super(t===1?Se:t===2?ye:me);u(this,"_score");this.type=t,this.type=t,this._score=Tt.scorePerType[t],this.pixelSize=Tt.pixelSize}getScore(){return this._score}getOriginalWidth(){return this.width/this.pixelSize}getOriginalHeight(){return this.height/this.pixelSize}}function we(a,i){return a.map((t,s)=>t+(i[s]??0))}var ot,H,at,C,b,lt,ct,k,F,T,ft,U,D,Et,Qt,bt,Xt,At,Zt,Lt,te;class ve{constructor(i){r(this,Et);r(this,bt);r(this,At);r(this,Lt);r(this,ot,1/0);r(this,H,void 0);r(this,at,void 0);r(this,C,void 0);r(this,b,void 0);r(this,lt,void 0);r(this,ct,void 0);r(this,k,void 0);r(this,F,void 0);r(this,T,void 0);r(this,ft,void 0);r(this,U,void 0);r(this,D,void 0);n(this,H,i.canvas.width),n(this,at,St.defaults.rows),n(this,C,0),n(this,b,Array.from({length:St.defaults.rows},()=>[])),n(this,lt,St.defaults.sideStep),n(this,ct,St.defaults.downStep),n(this,k,!0),n(this,F,!1),n(this,U,new Map),n(this,D,!1);const t=new yt;n(this,T,t.getOriginalWidth()),n(this,ft,t.getOriginalHeight())}getInvaders(){return e(this,U)}getBorders(){const i=[];return this.getInvaders().forEach(t=>{t?i.push(t.getBorders()):i.push({top:1/0,right:1/0,bottom:1/0,left:1/0})}),i}getFormationBorders(){let[i,t,s,h]=[1/0,0,0,1/0];return this.getInvaders().forEach(l=>{if(l){const c=l.getBorders();c.top!==1/0&&c.top<i&&(i=c.top),c.right!==1/0&&c.right>t&&(t=c.right),c.bottom!==1/0&&c.bottom>s&&(s=c.bottom),c.left!==1/0&&c.left<h&&(h=c.left)}}),{top:i,right:t,bottom:s,left:h}}remove(i){const[t,s]=i.split(",");e(this,b)[Number(t)][Number(s)]=0,e(this,U).set(i,null),f(this,bt,Xt).call(this)}prepare(){n(this,C,Math.floor(e(this,H)/2/e(this,T))),f(this,At,Zt).call(this),n(this,ot,e(this,C)*e(this,T));let i=-1;for(;++i<e(this,at);){let t=-1;for(;++t<e(this,C);){let s;i<=1?s=new yt(3):i===2||i===3?s=new yt(2):s=new yt(1),s.setPosition({x:e(this,H)/2-e(this,ot)/2+(e(this,T)+10)*t,y:e(this,ft)*i}),f(this,Et,Qt).call(this,`${i}, ${t}`,s)}}}isDestroyed(){return e(this,D)}update(){const i=this.getFormationBorders();i.left!==null&&i.left<10?(n(this,k,!0),n(this,F,!0)):i.right!==null&&i.right>e(this,H)?(n(this,k,!1),n(this,F,!0)):n(this,F,!1),this.getInvaders().forEach(t=>{if(t){const s=t.getPosition();t.setPosition({x:s.x+e(this,lt)*(e(this,k)?1:-1),y:s.y+(e(this,F)?e(this,ct):0)}),t.update()}})}draw(i){this.getInvaders().forEach(t=>{t&&t.draw(i)})}}ot=new WeakMap,H=new WeakMap,at=new WeakMap,C=new WeakMap,b=new WeakMap,lt=new WeakMap,ct=new WeakMap,k=new WeakMap,F=new WeakMap,T=new WeakMap,ft=new WeakMap,U=new WeakMap,D=new WeakMap,Et=new WeakSet,Qt=function(i,t){const[s,h]=i.split(",");e(this,b)[Number(s)][Number(h)]=1,e(this,U).set(i,t)},bt=new WeakSet,Xt=function(){f(this,Lt,te).call(this)===0?n(this,D,!0):n(this,D,!1)},At=new WeakSet,Zt=function(){e(this,b).fill(new Array(e(this,C)))},Lt=new WeakSet,te=function(){let i=new Array(e(this,b)[0].length).fill(0),t=e(this,b).length;for(;t--;)i=we(i,e(this,b)[t]);return i.reduce((s,h)=>s+h,0)};const xe=[[[1],[1],[1]]];class Pe extends Kt{constructor(){super(xe);u(this,"direction");this.direction=ht.defaults.direction,this.pixelSize=ht.pixelSize}update(){this.position.y+=this.direction*ht.updateStep}}const Ee=[[[0,0,0,1,0,0,0],[0,0,1,1,1,0,0],[1,1,1,1,1,1,1],[1,1,1,1,1,1,1]]];class be extends Kt{constructor(){super(Ee),this.pixelSize=Mt.pixelSize}}var g,m,S,y,J,Q,X,Z,tt,et,it,Rt,ee,It,ie,Ct,se,Ft,re,Ot,he,zt,ne;class Ae extends Wt{constructor(t){super(t);r(this,Rt);r(this,It);r(this,Ct);r(this,Ft);r(this,Ot);r(this,zt);r(this,g,void 0);r(this,m,null);r(this,S,null);r(this,y,null);r(this,J,0);r(this,Q,void 0);r(this,X,void 0);r(this,Z,void 0);r(this,tt,void 0);r(this,et,void 0);r(this,it,void 0);n(this,g,new ge),n(this,Q,f(this,Ot,he).bind(this)),n(this,X,f(this,zt,ne).bind(this)),n(this,Z,f(this,Ft,re).bind(this)),n(this,tt,f(this,Rt,ee).bind(this)),n(this,et,f(this,Ct,se).bind(this)),n(this,it,f(this,It,ie).bind(this))}connect(t,s,h){var l,c,w;super.connect(t,s,h),n(this,J,0),n(this,S,new be),e(this,S).setPosition({x:this.width/2,y:this.height-e(this,S).getHeight()/2-Mt.marginBottom}),n(this,m,new ve(this.ctx)),e(this,m).prepare(),e(this,g).watch({playerShip:e(this,S),invadersFleet:e(this,m)}),(l=this.gameControls)==null||l.on(o.Space,e(this,Z)),(c=this.gameControls)==null||c.on(o.Escape,e(this,X)),(w=this.gameControls)==null||w.on(o.Pause,e(this,Q)),e(this,g).on(A.Hit,e(this,tt)),e(this,g).on(A.Overfly,e(this,et)),e(this,g).on(A.Collision,e(this,it)),this.render()}leave(){var t,s,h;(t=this.gameControls)==null||t.off(o.Space,e(this,Z)),(s=this.gameControls)==null||s.off(o.Escape,e(this,X)),(h=this.gameControls)==null||h.off(o.Pause,e(this,Q)),e(this,g).off(A.Hit,e(this,tt)),e(this,g).off(A.Overfly,e(this,et)),e(this,g).off(A.Collision,e(this,it))}render(){var t,s,h,l,c,w;if(super.render(),e(this,S)){const p=e(this,S).getPosition(),v=e(this,S).getBorders();(t=this.gameControls)!=null&&t.isLeftPressed()&&v.left!==null&&v.left>10?p.x-=10:(s=this.gameControls)!=null&&s.isRightPressed()&&v.right!==null&&v.right<600&&(p.x+=10),e(this,S).setPosition(p),e(this,S).update(),e(this,S).draw(this.ctx)}e(this,y)&&(e(this,y).update(),e(this,y).draw(this.ctx)),(h=e(this,m))!=null&&h.isDestroyed()?(l=this.gameState)==null||l.update({isOver:!0}):((c=e(this,m))==null||c.update(),(w=e(this,m))==null||w.draw(this.ctx)),e(this,g).checkPositions()}}g=new WeakMap,m=new WeakMap,S=new WeakMap,y=new WeakMap,J=new WeakMap,Q=new WeakMap,X=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,it=new WeakMap,Rt=new WeakSet,ee=function(t){var l,c,w,p,v,st;const s=((c=(l=e(this,m))==null?void 0:l.getInvaders().get(t))==null?void 0:c.getScore())||0,h=((w=this.gameState)==null?void 0:w.get("totalScore"))||0;(p=this.gameState)==null||p.update({totalScore:h+s}),(v=e(this,m))==null||v.remove(t),n(this,y,null),e(this,g).unwatch({laserRay:e(this,y)}),(st=this.gameSounds)==null||st.explosion.play()},It=new WeakSet,ie=function(){var t,s;n(this,S,null),n(this,m,null),n(this,y,null),e(this,g).unwatch({invadersFleet:e(this,m),laserRay:e(this,y),playerShip:e(this,S)}),(t=this.gameSounds)==null||t.explosion.play(),(s=this.gameState)==null||s.update({isOver:!0})},Ct=new WeakSet,se=function(){n(this,y,null),e(this,g).unwatch({laserRay:e(this,y)})},Ft=new WeakSet,re=function(){var t,s;if(e(this,J)<Date.now()-ht.reload){n(this,y,new Pe),e(this,g).watch({laserRay:e(this,y),invadersFleet:e(this,m)});const h=(t=e(this,S))==null?void 0:t.getPosition();h&&(e(this,y).setPosition({x:h.x,y:h.y-ht.marginBottom}),n(this,J,Date.now()),(s=this.gameSounds)==null||s.playerShoot.play())}},Ot=new WeakSet,he=function(){var t;(t=this.gameState)==null||t.update({isPaused:!this.gameState.get("isPaused")})},zt=new WeakSet,ne=function(){var t;(t=this.gameState)==null||t.update({isStarted:!1,isOver:!1,isPaused:!1,totalScore:0})};var E,x,q,dt,W,O,I,ut,pt,K,rt,gt,Dt,Bt,oe,Ht,ae;class Le{constructor(i,t,s){r(this,K);r(this,gt);r(this,Bt);r(this,Ht);r(this,E,void 0);r(this,x,void 0);r(this,q,void 0);r(this,dt,void 0);r(this,W,void 0);r(this,O,null);r(this,I,null);r(this,ut,void 0);r(this,pt,void 0);n(this,E,i),e(this,E).font=Ut.font,e(this,E).textBaseline=Ut.textBaseline,e(this,E).textAlign=Ut.textAlign,n(this,x,new ue(fe)),n(this,q,new de),n(this,dt,t),n(this,W,s),e(this,W).lives.textContent=String(e(this,x).get("lives")),e(this,W).totalScore.textContent=String(e(this,x).get("totalScore")),n(this,ut,h=>e(this,q).onKeyDown(h)),n(this,pt,h=>e(this,q).onKeyUp(h))}getScreen(){return e(this,O)}start(){f(this,Bt,oe).call(this),f(this,Ht,ae).call(this),f(this,K,rt).call(this,new jt(e(this,E)))}pause(){e(this,I)!==null&&clearInterval(e(this,I))}resume(){n(this,I,setInterval(()=>{f(this,gt,Dt).call(this)},1e3/mt))}stop(){e(this,I)!==null&&clearInterval(e(this,I)),f(this,K,rt).call(this,new pe(e(this,E)))}}E=new WeakMap,x=new WeakMap,q=new WeakMap,dt=new WeakMap,W=new WeakMap,O=new WeakMap,I=new WeakMap,ut=new WeakMap,pt=new WeakMap,K=new WeakSet,rt=function(i){var t;(t=e(this,O))==null||t.leave(),n(this,O,i),e(this,O).connect(e(this,x),e(this,q),e(this,dt))},gt=new WeakSet,Dt=function(){var i;(i=e(this,O))==null||i.render()},Bt=new WeakSet,oe=function(){window.addEventListener("keydown",e(this,ut)),window.addEventListener("keyup",e(this,pt))},Ht=new WeakSet,ae=function(){e(this,x).on("isStarted",i=>{i?(f(this,K,rt).call(this,new Ae(e(this,E))),n(this,I,setInterval(()=>{f(this,gt,Dt).call(this)},1e3/mt))):f(this,K,rt).call(this,new jt(e(this,E)))}),e(this,x).on("isPaused",i=>{i?this.pause():e(this,x).get("isStarted")&&this.resume()}),e(this,x).on("isOver",i=>{i&&this.stop()}),e(this,x).on("totalScore",i=>{i&&(e(this,W).totalScore.textContent=String(i))})};const L=document.querySelector("#app"),nt=L.querySelector("#game-canvas");nt.width=nt.clientWidth;nt.height=nt.clientHeight;const Re={explosion:L.querySelector("#explosion"),playerShoot:L.querySelector("#player-shoot"),invaderShoot:L.querySelector("#invader-shoot"),invadersFleetFly:L.querySelector("#invaders-fleet-fly"),invadersFleetFly2:L.querySelector("#invaders-fleet-fly-2"),misteryShipFly:L.querySelector("#mistery-ship-fly")},Ie={totalScore:L.querySelector("#total-score"),lives:L.querySelector("#lives")},Gt=nt.getContext("2d");Gt!==null&&new Le(Gt,Re,Ie).start();
